C:\Git_Repos\mana_meeples_singles_market>pnpm --filter ./apps/api test

> @mana-meeples/api@ test C:\Git_Repos\mana_meeples_singles_market\apps\api
> vitest


 DEV  v2.1.9 C:/Git_Repos/mana_meeples_singles_market/apps/api

stdout | tests/integration/auth.routes.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > rejects login with missing credentials
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:00.909Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'MISSING', hasPassword: false }

stderr | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > rejects login with missing credentials
‚ùå Missing credentials

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > rejects login with invalid credentials
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:00.929Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'admin', hasPassword: true }
üîç Validating credentials...

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > rejects login with invalid credentials
‚ùå Invalid credentials

stdout | tests/integration/cards.search.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops

stderr | tests/integration/cards.search.test.ts
‚ö†Ô∏è Unexpected database pool error: terminating connection due to administrator command

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > accepts valid admin credentials and sets cookie
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:02.001Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'admin', hasPassword: true }
üîç Validating credentials...

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > accepts valid admin credentials and sets cookie
‚ùå Invalid credentials

stdout | tests/e2e/checkout.flow.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: üóÇÔ∏è backup and recover secrets: https://dotenvx.com/ops

stdout | tests/integration/error-handling.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: üóÇÔ∏è backup and recover secrets: https://dotenvx.com/ops

stdout | tests/integration/auth.routes.test.ts > POST /api/auth/admin/logout > clears the admin token cookie
üîê AUTH POST /api/auth/admin/logout - 2025-10-21T23:53:03.067Z
üö™ Admin logout request

stdout | tests/integration/auth.routes.test.ts > GET /api/auth/admin/check > returns 401 when no token provided
üîê AUTH GET /api/auth/admin/check - 2025-10-21T23:53:03.075Z

stdout | tests/integration/auth.routes.test.ts > GET /api/auth/admin/check > returns authenticated status with valid token
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:03.084Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'admin', hasPassword: true }
üîç Validating credentials...

stdout | tests/integration/orders.routes.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops

stdout | tests/integration/inventory.routes.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }

stdout | tests/integration/auth.routes.test.ts > GET /api/auth/admin/check > returns authenticated status with valid token
‚ùå Invalid credentials

stdout | tests/integration/storefront.routes.test.ts
[dotenv@17.2.3] injecting env (21) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }

stdout | tests/integration/error-handling.test.ts > Error Handling > 400 Bad Request > returns 400 for malformed request body
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:03.160Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'MISSING', hasPassword: false }

stderr | tests/integration/error-handling.test.ts > Error Handling > 400 Bad Request > returns 400 for malformed request body
‚ùå Missing credentials

stderr | tests/integration/error-handling.test.ts > Error Handling > 401 Unauthorized > returns 401 for protected routes without auth
‚ùå No admin token found in cookies

stdout | tests/integration/orders.routes.test.ts
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:03.174Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'admin', hasPassword: true }
üîç Validating credentials...

stdout | tests/integration/error-handling.test.ts > Error Handling > Content-Type validation > requires JSON content-type for POST requests
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:03.178Z
üîë Admin login attempt - handler entered

stderr | tests/integration/error-handling.test.ts > Error Handling > Content-Type validation > requires JSON content-type for POST requests
‚ùå Login error: TypeError: Cannot destructure property 'username' of 'req.body' as it is undefined.
    at C:\Git_Repos\mana_meeples_singles_market\apps\api\src\routes\auth.ts:32:13
    at Layer.handleRequest (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\layer.js:152:17)
    at next (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\route.js:157:13)
    at Route.dispatch (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\route.js:117:3)
    at handle (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:435:11)
    at Layer.handleRequest (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\layer.js:152:17)
    at C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:295:15
    at processParams (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:582:12)
    at next (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:291:5)
    at C:\Git_Repos\mana_meeples_singles_market\apps\api\src\routes\auth.ts:21:3
‚ùå Error stack: TypeError: Cannot destructure property 'username' of 'req.body' as it is undefined.
    at C:\Git_Repos\mana_meeples_singles_market\apps\api\src\routes\auth.ts:32:13
    at Layer.handleRequest (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\layer.js:152:17)
    at next (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\route.js:157:13)
    at Route.dispatch (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\route.js:117:3)
    at handle (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:435:11)
    at Layer.handleRequest (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\lib\layer.js:152:17)
    at C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:295:15
    at processParams (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:582:12)
    at next (C:\Git_Repos\mana_meeples_singles_market\node_modules\.pnpm\router@2.2.0\node_modules\router\index.js:291:5)
    at C:\Git_Repos\mana_meeples_singles_market\apps\api\src\routes\auth.ts:21:3

stdout | tests/integration/inventory.routes.test.ts
üîê AUTH POST /api/auth/admin/login - 2025-10-21T23:53:03.203Z
üîë Admin login attempt - handler entered
üìã Credentials received: { username: 'admin', hasPassword: true }
üîç Validating credentials...

stdout | tests/integration/orders.routes.test.ts
‚ùå Invalid credentials

stdout | tests/integration/inventory.routes.test.ts
‚ùå Invalid credentials

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > completes a full customer journey from browsing to order placement
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles out-of-stock scenario gracefully
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles concurrent orders for the same item
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > allows admin to cancel an order and restore inventory
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > validates customer input sanitization during checkout
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

stderr | tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles multiple items in a single order
‚ùå Database query error: relation "card_pricing" does not exist
   Query:
    WITH latest_prices AS (
      SELECT DISTINCT ON (card_id)
             card_id, base_price, foil_price, price_source, updated_at
      FROM card_pricing
      ORDER BY card_id, updated_at DESC N
   Params: [100,0]
   Code: 42P01
GET /storefront/cards failed { code: '42P01', message: 'relation "card_pricing" does not exist' }

 ‚ùØ tests/e2e/checkout.flow.test.ts (6) 16861ms
   ‚ùØ Complete Checkout Flow (E2E) (6) 851ms
     √ó completes a full customer journey from browsing to order placement
     √ó handles out-of-stock scenario gracefully
     √ó handles concurrent orders for the same item
     √ó allows admin to cancel an order and restore inventory
     √ó validates customer input sanitization during checkout
     √ó handles multiple items in a single order
 ‚ùØ tests/integration/auth.routes.test.ts (6) 17267ms
   ‚ùØ POST /api/auth/admin/login (3) 2187ms
     ‚úì rejects login with missing credentials
     ‚úì rejects login with invalid credentials 1073ms
     √ó accepts valid admin credentials and sets cookie 1068ms
   ‚úì POST /api/auth/admin/logout (1)
   ‚ùØ GET /api/auth/admin/check (2) 1082ms
     √ó returns 401 when no token provided
     √ó returns authenticated status with valid token 1073ms
 ‚úì tests/integration/cards.search.test.ts (1) 14721ms
 ‚ùØ tests/integration/error-handling.test.ts (7) 16131ms
   ‚ùØ Error Handling (7)
     ‚úì 404 Not Found (2)
     ‚úì 400 Bad Request (2)
     ‚úì 401 Unauthorized (1)
     ‚ùØ 500 Internal Server Error (1)
       √ó handles database errors gracefully
     ‚ùØ Content-Type validation (1)
       √ó requires JSON content-type for POST requests
 ‚ùØ tests/integration/inventory.routes.test.ts (16) 17625ms
   / [ beforeAll ]
   ‚Üì POST /api/admin/inventory (6) [skipped]
   ‚Üì GET /api/admin/inventory (3) [skipped]
   ‚Üì PATCH /api/admin/inventory/:id (4) [skipped]
   ‚Üì DELETE /api/admin/inventory/:id (3) [skipped]
 ‚ùØ tests/integration/orders.routes.test.ts (19) 17422ms
   / [ beforeAll ]
   ‚Üì POST /api/orders (6) [skipped]
   ‚Üì GET /api/admin/orders (5) [skipped]
   ‚Üì GET /api/admin/orders/:id (3) [skipped]
   ‚Üì PATCH /api/admin/orders/:id/status (5) [skipped]
 ‚ùØ tests/integration/storefront.routes.test.ts (5) 16245ms
   ‚ùØ GET /api/storefront/cards (5) 309ms
     √ó returns paginated cards with default params
       | [ beforeEach ]
     √ó filters cards by game_id
       | [ beforeEach ]
     √ó filters cards by search term
       / [ beforeEach ]
     √ó respects pagination parameters
       \ [ beforeEach ]
     √ó returns 400 for invalid query parameters
       / [ beforeEach ]
 ‚úì tests/unit/auth.validateCredentials.test.ts (4)
 ‚úì tests/unit/slugify.test.ts (1)
 ‚ùØ tests/unit/utils.test.ts (42)
   ‚ùØ String Utilities (24)
     ‚ùØ slugify (10)
       ‚úì converts text to lowercase
       ‚úì replaces spaces with hyphens
       ‚úì removes special characters
       √ó handles unicode characters
       ‚úì removes leading and trailing hyphens
       ‚úì collapses multiple hyphens to single hyphen
       ‚úì handles empty string
       ‚úì handles string with only special characters
       ‚úì preserves numbers
       ‚úì handles underscores
     ‚úì truncate (6)
     ‚úì titleCase (8)
   ‚úì Database Query Builders (1)
   ‚úì Validation Helpers (1)
   ‚úì Price Formatting (4)
   ‚úì Date Utilities (4)
   ‚úì Array Utilities (8)
 ‚úì tests/unit/validation.test.ts (10)

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ Failed Suites 2 ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ

 FAIL  tests/integration/inventory.routes.test.ts [ tests/integration/inventory.routes.test.ts ]
TypeError: Cannot read properties of undefined (reading '0')
 ‚ùØ tests/integration/inventory.routes.test.ts:27:44
     25|     });
     26|
     27|   authToken = loginRes.headers["set-cookie"][0];
       |                                            ^
     28| }, 60_000);
     29|

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/19]‚éØ

 FAIL  tests/integration/orders.routes.test.ts [ tests/integration/orders.routes.test.ts ]
TypeError: Cannot read properties of undefined (reading '0')
 ‚ùØ tests/integration/orders.routes.test.ts:27:44
     25|     });
     26|
     27|   authToken = loginRes.headers["set-cookie"][0];
       |                                            ^
     28| }, 60_000);
     29|

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/19]‚éØ

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ Failed Tests 17 ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > completes a full customer journey from browsing to order placement
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:36:8
     34|     const browseRes = await request(app)
     35|       .get("/api/storefront/cards")
     36|       .expect(200);
       |        ^
     37|
     38|     expect(browseRes.body.cards).toBeDefined();
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/19]‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles out-of-stock scenario gracefully
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:165:8
    163|     const browseRes = await request(app)
    164|       .get("/api/storefront/cards")
    165|       .expect(200);
       |        ^
    166|
    167|     const card = browseRes.body.cards[0];
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/19]‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles concurrent orders for the same item
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:205:8
    203|     const browseRes = await request(app)
    204|       .get("/api/storefront/cards")
    205|       .expect(200);
       |        ^
    206|
    207|     const card = browseRes.body.cards[0];
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/19]‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > allows admin to cancel an order and restore inventory
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:258:8
    256|     const browseRes = await request(app)
    257|       .get("/api/storefront/cards")
    258|       .expect(200);
       |        ^
    259|
    260|     const card = browseRes.body.cards[0];
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/19]‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > validates customer input sanitization during checkout
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:330:8
    328|     const browseRes = await request(app)
    329|       .get("/api/storefront/cards")
    330|       .expect(200);
       |        ^
    331|
    332|     const card = browseRes.body.cards[0];
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/19]‚éØ

 FAIL  tests/e2e/checkout.flow.test.ts > Complete Checkout Flow (E2E) > handles multiple items in a single order
Error: expected 200 "OK", got 500 "Internal Server Error"
 ‚ùØ tests/e2e/checkout.flow.test.ts:390:8
    388|     const browseRes = await request(app)
    389|       .get("/api/storefront/cards")
    390|       .expect(200);
       |        ^
    391|
    392|     const card = browseRes.body.cards[0];
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/19]‚éØ

 FAIL  tests/integration/auth.routes.test.ts > POST /api/auth/admin/login > accepts valid admin credentials and sets cookie
Error: expected 200 "OK", got 401 "Unauthorized"
 ‚ùØ tests/integration/auth.routes.test.ts:51:8
     49|         password: process.env.ADMIN_PASSWORD || "your_test_password"
     50|       })
     51|       .expect(200);
       |        ^
     52|
     53|     expect(res.body.success).toBe(true);
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[9/19]‚éØ

 FAIL  tests/integration/auth.routes.test.ts > GET /api/auth/admin/check > returns 401 when no token provided
Error: expected 401 "Unauthorized", got 404 "Not Found"
 ‚ùØ tests/integration/auth.routes.test.ts:75:8
     73|     const res = await request(app)
     74|       .get("/api/auth/admin/check")
     75|       .expect(401);
       |        ^
     76|
     77|     expect(res.body.authenticated).toBe(false);
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[10/19]‚éØ

 FAIL  tests/integration/auth.routes.test.ts > GET /api/auth/admin/check > returns authenticated status with valid token
TypeError: Invalid value "undefined" for header "Cookie"
 ‚ùØ Test.request ../../node_modules/.pnpm/superagent@10.2.3/node_modules/superagent/src/node/index.js:830:39
 ‚ùØ Test.Request.end ../../node_modules/.pnpm/superagent@10.2.3/node_modules/superagent/src/node/index.js:965:8
 ‚ùØ Test.end ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:136:11
 ‚ùØ ../../node_modules/.pnpm/superagent@10.2.3/node_modules/superagent/src/request-base.js:283:12
 ‚ùØ Test.RequestBase.then ../../node_modules/.pnpm/superagent@10.2.3/node_modules/superagent/src/request-base.js:265:31

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[11/19]‚éØ

 FAIL  tests/integration/error-handling.test.ts > Error Handling > 500 Internal Server Error > handles database errors gracefully
AssertionError: expected undefined to be defined
 ‚ùØ tests/integration/error-handling.test.ts:76:27
     74|       // This would require mocking the database to fail
     75|       // For now, we can test the error handler is in place
     76|       expect(app._router).toBeDefined();
       |                           ^
     77|     });
     78|   });

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[12/19]‚éØ

 FAIL  tests/integration/error-handling.test.ts > Error Handling > Content-Type validation > requires JSON content-type for POST requests
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 ‚ùØ tests/integration/error-handling.test.ts:85:10
     83|         .post("/api/auth/admin/login")
     84|         .send("not-json-data")
     85|         .expect(400);
       |          ^
     86|
     87|       // Should fail to parse as JSON
 ‚ùØ Test._assertStatus ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14
 ‚ùØ ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
 ‚ùØ Test._assertFunction ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13
 ‚ùØ Test.assert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23
 ‚ùØ localAssert ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14
 ‚ùØ Server.<anonymous> ../../node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[13/19]‚éØ

 FAIL  tests/integration/storefront.routes.test.ts > GET /api/storefront/cards > returns paginated cards with default params
 FAIL  tests/integration/storefront.routes.test.ts > GET /api/storefront/cards > filters cards by game_id
 FAIL  tests/integration/storefront.routes.test.ts > GET /api/storefront/cards > filters cards by search term
 FAIL  tests/integration/storefront.routes.test.ts > GET /api/storefront/cards > respects pagination parameters
 FAIL  tests/integration/storefront.routes.test.ts > GET /api/storefront/cards > returns 400 for invalid query parameters
error: relation "card_sets" does not exist
 ‚ùØ ../../node_modules/.pnpm/pg@8.16.3/node_modules/pg/lib/client.js:545:17
 ‚ùØ Module.seedMultipleCards tests/setup/db.ts:65:5
     63|
     64|     // Seed card sets
     65|     await client.query(
       |     ^
     66|       `INSERT INTO card_sets (id, name, game_id) VALUES
     67|        (1, 'Alpha', 1),
 ‚ùØ tests/integration/storefront.routes.test.ts:26:5

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[14/19]‚éØ

 FAIL  tests/unit/utils.test.ts > String Utilities > slugify > handles unicode characters
AssertionError: expected 'caf-mnchn' to be 'caf-mnchen' // Object.is equality

Expected: "caf-mnchen"
Received: "caf-mnchn"

 ‚ùØ tests/unit/utils.test.ts:22:39
     20|
     21|     it("handles unicode characters", () => {
     22|       expect(slugify("Caf√© M√ºnch√´n")).toBe("caf-mnchen");
       |                                       ^
     23|     });
     24|

‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[15/19]‚éØ

 Test Files  7 failed | 4 passed (11)
      Tests  17 failed | 65 passed | 35 skipped (117)
   Start at  12:52:46
   Duration  18.83s (transform 608ms, setup 0ms, collect 6.34s, tests 116.43s, environment 2ms, prepare 1.33s)

 FAIL  Tests failed. Watching for file changes...