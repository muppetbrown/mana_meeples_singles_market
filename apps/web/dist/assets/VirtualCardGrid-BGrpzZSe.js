import{r as e,j as r}from"./index-DpUM0y5P.js";import{c as k}from"./CurrencySelector-C6moJEjC.js";const z=({items:t=[],itemHeight:c=420,containerHeight:g=800,overscan:u=2,columnCount:s=4})=>{const[n,x]=e.useState(0),[i,j]=e.useState({width:0,height:g}),[S,m]=e.useState(!1),l=e.useRef(null),d=e.useRef(null),b=e.useRef(t.length);e.useEffect(()=>(t.length!==b.current&&(m(!0),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{x(0),m(!1),b.current=t.length},50)),()=>{l.current&&clearTimeout(l.current)}),[t.length]);const f=e.useMemo(()=>{const a=c,h=Math.ceil(t.length/s),v=Math.ceil(i.height/a),o=Math.max(0,Math.floor(n/a)-u),p=Math.min(h-1,o+v+u*2),C=o*s,y=Math.min(t.length-1,(p+1)*s-1);return{startIndex:C,endIndex:y,startRow:o,endRow:p,totalRows:h,visibleRowCount:v}},[t.length,s,i.height,n,c,u]),w=e.useMemo(()=>t.slice(f.startIndex,f.endIndex+1),[t,f.startIndex,f.endIndex]),N=e.useMemo(()=>Math.ceil(t.length/s)*c,[t.length,s,c]),I=e.useMemo(()=>f.startRow*c,[f.startRow,c]),T=e.useCallback(a=>{x(a.currentTarget.scrollTop)},[]),E=e.useCallback(a=>{if(!a)return;d.current&&d.current.disconnect();const h=new ResizeObserver(v=>{for(const o of v){const{width:p,height:C}=o.contentRect;j(y=>y.width===p&&y.height===C?y:{width:p,height:C})}});return h.observe(a),d.current=h,()=>{h.disconnect(),d.current===h&&(d.current=null)}},[]),R=e.useMemo(()=>i.width===0?s:i.width<640?1:i.width<1024?2:i.width<1280?3:4,[i.width,s]),M=e.useCallback(a=>Math.floor(a/R)*c,[R,c]);return e.useEffect(()=>()=>{l.current&&clearTimeout(l.current),d.current&&d.current.disconnect()},[]),{visibleItems:w,totalHeight:N,offsetY:I,handleScroll:T,updateContainerSize:E,responsiveColumnCount:R,scrollToItem:M,visibleRange:f,isLoading:S}},$=({initialBatchSize:t=100,batchSize:c=50,totalItems:g=0})=>{const[u,s]=e.useState(t),[n,x]=e.useState(!1),i=e.useCallback(()=>{n||u>=g||(x(!0),setTimeout(()=>{s(m=>Math.min(m+c,g)),x(!1)},100))},[n,u,g,c]),j=e.useCallback(()=>{s(t),x(!1)},[t]),S=u<g;return{loadedCount:u,isLoading:n,hasMore:S,loadMore:i,reset:j}},Y=({cards:t=[],CardComponent:c,cardHeight:g=420,containerHeight:u=800,enableProgressiveLoading:s=!0,onLoadMore:n,...x})=>{const i=e.useRef(null),[j,S]=e.useState({height:u}),{loadedCount:m,isLoading:l,hasMore:d,loadMore:b,reset:f}=$({initialBatchSize:100,batchSize:50,totalItems:t.length}),w=s?t.slice(0,m):t,{visibleItems:N,totalHeight:I,offsetY:T,handleScroll:E,updateContainerSize:R,responsiveColumnCount:M,visibleRange:a}=z({items:w,itemHeight:g,containerHeight:j.height,overscan:2,columnCount:4});e.useEffect(()=>{if(i.current)return R(i.current)},[R]),e.useEffect(()=>{if(i.current){const o=i.current.getBoundingClientRect();S({height:Math.max(o.height,u)})}},[u]),e.useEffect(()=>{if(!s)return;a.endIndex>=w.length-10&&d&&!l&&(b(),n==null||n())},[a.endIndex,w.length,d,l,b,n,s]),e.useEffect(()=>{f()},[t.length,f]);const h=e.useCallback(()=>{switch(M){case 1:return"grid-cols-1";case 2:return"grid-cols-2";case 3:return"grid-cols-3";case 4:return"grid-cols-4";default:return"grid-cols-4"}},[M]),v=e.useCallback(()=>{d&&!l&&(b(),n==null||n())},[d,l,b,n]);return w.length<=20?r.jsxs("div",{className:`grid ${h()} gap-4 sm:gap-6`,children:["// @ts-expect-error TS(7006): Parameter 'card' implicitly has an 'any' type.",w.map((o,p)=>r.jsx("div",{children:r.jsx(c,{card:o,...x})},o.id||p))]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{ref:i,className:"relative overflow-y-auto",style:{height:`${Math.min(I,u)}px`,maxHeight:"80vh"},onScroll:E,role:"region","aria-label":"Card grid","aria-live":"polite","aria-busy":l,children:[r.jsx("div",{style:{height:`${I}px`,position:"relative"},children:r.jsx("div",{style:{transform:`translateY(${T}px)`,position:"absolute",top:0,left:0,right:0},children:r.jsx("div",{className:`grid ${h()} gap-4 sm:gap-6`,children:N.map((o,p)=>{const C=a.startIndex+p;return r.jsx("div",{style:{minHeight:`${g-24}px`},children:r.jsx(c,{card:o,...x})},o.id||C)})})})}),l&&r.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg px-4 py-2 flex items-center gap-2 text-sm text-slate-600",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Loading more cards..."]})})]}),s&&d&&!l&&r.jsx("div",{className:"text-center",children:r.jsxs("button",{onClick:v,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors focus:ring-4 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none","aria-label":"Load more cards",children:[r.jsx(k,{className:"w-4 h-4"}),"Load More Cards (",t.length-m," remaining)"]})}),!1]})};export{Y as default};
